generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Plan {
  free  
  pro
}

model User {
  id                   String   @id @default(cuid())
  email                String?  @unique
  plan                 Plan     @default(free)

  stripeCustomerId     String?  @unique
  stripeSubscriptionId String?  @unique

  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  reports              AnalysisReport[]
}





model AnalysisReport {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id])

  // estado
  status      String   // "processing" | "done" | "error"

  // input
  audioKey    String
  durationSec Int
  wasTrimmed  Boolean @default(false)

  // output
  transcript  String? // PRO only (pero se guarda igual)
  reportFull  String? // texto completo IA
  reportFree  String? // versi√≥n recortada para FREE

  createdAt   DateTime @default(now())
}
